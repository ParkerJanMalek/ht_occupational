  Beginning data_processing.py script.

  Loading raw OSHA data 1984-2018...
  Unzipping osha monitoring data...

  Loading SIC and NAICS crosswalk files...
  Loading DSSTox chemical data and OPERA predictions for chemicals in the OSHA dataset...
  Dropping bulk samples, blanks and invalid concentration results...
  Initial N, all air samples: 1585949
  Initial N, personal air samples: 1524921
  Initial N, area air samples: 61028
  Dropping substances with no DSSTox match...
  1585949 rows before adding dsstox ID, 1138207 after
  Converting all units to mg/m3...
  finding looplift candidates
  Converting SIC and old NAICS codes to NAICS 2017 and assigning sector/subsector names...
  Rows dropped for undefined NAICS sector/subsector: 259299 out of 1138207
  rows dropped for undefined sample concentration: 18062 out of 878908
  Aggregating observations by inspection number and taking max...
  Max, median and min number of obs per inspection: 281, 3.0 and 1
  860846 rows before aggregating by inspection, 197985 rows after.
  Detecting and removing extreme outliers (z score > 4)...
  outliers removed: 487 out of 197985
  Rows dropped for subsector insufficient data (less than 10 observations): 394 out of 197498
  Assigning OPERA predictions and calculating interaction terms...
  Rows dropped for no OPERA predictions (e.g. inorganics): 150107 out of 197104
